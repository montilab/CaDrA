<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Permutation-Based Testing • CaDrA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Permutation-Based Testing">
<meta property="og:description" content="CaDrA">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CaDrA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/permutation_based_testing.html">Permutation-Based Testing</a>
    </li>
    <li>
      <a href="../articles/scoring_functions.html">Scoring Functions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/montilab/CaDrA/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Permutation-Based Testing</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/montilab/CaDrA/blob/HEAD/vignettes/permutation_based_testing.Rmd" class="external-link"><code>vignettes/permutation_based_testing.Rmd</code></a></small>
      <div class="hidden name"><code>permutation_based_testing.Rmd</code></div>

    </div>

    
    
<p><strong>CaDrA</strong> implements a forward/backward search algorithm
to look for a subset of features whose union is maximally associated
with an outcome of interest, based on (currently) one of four scoring
functions (<strong>Kolmogorov-Smirnov</strong>, <strong>Conditional
Mutual Information</strong>, <strong>Wilcoxon</strong>, and
<strong>custom-defined</strong>). To test whether the strength of the
association between the set of features and the observed input scores
(e.g., pathway activity, drug sensitivity, etc.) is greater than it
would be expected by chance, <strong>CaDrA</strong> supports
permutation-based significance testing. Importantly, the permutation
test iterates over the entire search procedure (e.g., if
<code>top_N = 7</code>, each permutation iteration will consist of
running the search over the top 7 features).</p>
<div class="section level2">
<h2 id="load-packages">Load packages<a class="anchor" aria-label="anchor" href="#load-packages"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/montilab/CaDrA/" class="external-link">CaDrA</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-required-datasets">Load required datasets<a class="anchor" aria-label="anchor" href="#load-required-datasets"></a>
</h2>
<ol style="list-style-type: decimal">
<li>A <code>binary features matrix</code> also known as
<code>Feature Set</code> (such as somatic mutations, copy number
alterations, chromosomal translocations, etc.) The 1/0 row vectors
indicate the presence/absence of ‘omics’ features in the samples. The
<code>Feature Set</code> must be an object of class
<strong>SummarizedExperiment</strong> from
<strong>SummarizedExperiment</strong> package)</li>
<li>A vector of continuous scores (or <code>input_score</code>)
representing a functional response of interest (such as protein
expression, pathway activity, etc.)</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load pre-simulated feature set </span></span>
<span><span class="co"># See ?sim_FS for more information</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sim_FS</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load pre-computed input-score</span></span>
<span><span class="co"># See ?sim_Scores for more information</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sim_Scores</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="find-a-subset-of-features-that-maximally-associated-with-a-given-outcome-of-interest">Find a subset of features that maximally associated with a given
outcome of interest<a class="anchor" aria-label="anchor" href="#find-a-subset-of-features-that-maximally-associated-with-a-given-outcome-of-interest"></a>
</h2>
<p>Here we are using <strong>Kolmogorow-Smirnow</strong> (KS) scoring
method to search for best features</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ks_candidate</span> <span class="op">&lt;-</span> <span class="fu">CaDrA</span><span class="fu">::</span><span class="fu"><a href="../reference/candidate_search.html">candidate_search</a></span><span class="op">(</span></span>
<span>  FS <span class="op">=</span> <span class="va">sim_FS</span>,</span>
<span>  input_score <span class="op">=</span> <span class="va">sim_Scores</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"ks_pval"</span>,          <span class="co"># Use Kolmogorow-Smirnow scoring function </span></span>
<span>  alternative <span class="op">=</span> <span class="st">"less"</span>,        <span class="co"># Use one-sided hypothesis testing</span></span>
<span>  weight <span class="op">=</span> <span class="cn">NULL</span>,               <span class="co"># If weight is provided, perform a weighted-KS test</span></span>
<span>  search_method <span class="op">=</span> <span class="st">"both"</span>,      <span class="co"># Apply both forward and backward search</span></span>
<span>  top_N <span class="op">=</span> <span class="fl">7</span>,                   <span class="co"># Number of top features to kick start the search</span></span>
<span>  max_size <span class="op">=</span> <span class="fl">10</span>,               <span class="co"># Allow at most 10 features in meta-feature matrix</span></span>
<span>  best_score_only <span class="op">=</span> <span class="cn">FALSE</span>      <span class="co"># Return meta-feature, its observed input scores and corresponding best score</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualize-best-meta-features-result">Visualize best meta-features result<a class="anchor" aria-label="anchor" href="#visualize-best-meta-features-result"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract the best meta-feature result</span></span>
<span><span class="va">topn_best_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/topn_best.html">topn_best</a></span><span class="op">(</span>topn_list <span class="op">=</span> <span class="va">ks_candidate</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize meta-feature result</span></span>
<span><span class="fu"><a href="../reference/meta_plot.html">meta_plot</a></span><span class="op">(</span>topn_best_list <span class="op">=</span> <span class="va">topn_best_meta</span><span class="op">)</span></span></code></pre></div>
<p><img src="permutation_based_testing_files/figure-html/ks.meta.plot-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="permutation-based-testing">Permutation-based testing<a class="anchor" aria-label="anchor" href="#permutation-based-testing"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">ks_perm_res</span> <span class="op">&lt;-</span> <span class="fu">CaDrA</span><span class="fu">::</span><span class="fu"><a href="../reference/CaDrA.html">CaDrA</a></span><span class="op">(</span></span>
<span>  FS <span class="op">=</span> <span class="va">sim_FS</span>, </span>
<span>  input_score <span class="op">=</span> <span class="va">sim_Scores</span>, </span>
<span>  method <span class="op">=</span> <span class="st">"ks_pval"</span>,          <span class="co"># Use Kolmogorow-Smirnow scoring function </span></span>
<span>  weight <span class="op">=</span> <span class="cn">NULL</span>,               <span class="co"># If weight is provided, perform a weighted-KS test</span></span>
<span>  alternative <span class="op">=</span> <span class="st">"less"</span>,        <span class="co"># Use one-sided hypothesis testing</span></span>
<span>  search_method <span class="op">=</span> <span class="st">"both"</span>,      <span class="co"># Apply both forward and backward search</span></span>
<span>  top_N <span class="op">=</span> <span class="fl">7</span>,                   <span class="co"># Repeat the search with the top N features</span></span>
<span>  max_size <span class="op">=</span> <span class="fl">10</span>,               <span class="co"># Allow at most 10 features in the meta-feature matrix</span></span>
<span>  n_perm <span class="op">=</span> <span class="fl">1000</span>,               <span class="co"># Number of permutations</span></span>
<span>  plot <span class="op">=</span> <span class="cn">FALSE</span>,                <span class="co"># We will plot later</span></span>
<span>  ncores <span class="op">=</span> <span class="fl">1</span>                   <span class="co"># Number of cores to perform parallelization</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualize-permutation-result">Visualize permutation result<a class="anchor" aria-label="anchor" href="#visualize-permutation-result"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Visualize permutation results</span></span>
<span><span class="fu"><a href="../reference/permutation_plot.html">permutation_plot</a></span><span class="op">(</span>perm_res <span class="op">=</span> <span class="va">ks_perm_res</span><span class="op">)</span></span></code></pre></div>
<p><img src="ks_permutation_plot.png"></p>
</div>
<div class="section level2">
<h2 id="sessioninfo">SessionInfo<a class="anchor" aria-label="anchor" href="#sessioninfo"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>R version 4.2.3 (2023-03-15)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.2 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats4    stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] CaDrA_0.99.2                SummarizedExperiment_1.28.0
 [3] Biobase_2.58.0              GenomicRanges_1.50.2       
 [5] GenomeInfoDb_1.34.9         IRanges_2.32.0             
 [7] S4Vectors_0.36.2            BiocGenerics_0.44.0        
 [9] MatrixGenerics_1.10.0       matrixStats_0.63.0         
[11] BiocStyle_2.26.0           

loaded via a namespace (and not attached):
 [1] sass_0.4.5             jsonlite_1.8.4         foreach_1.5.2         
 [4] R.utils_2.12.2         gtools_3.9.4           bslib_0.4.2           
 [7] highr_0.10             BiocManager_1.30.20    GenomeInfoDbData_1.2.9
[10] yaml_2.3.7             pillar_1.8.1           lattice_0.20-45       
[13] glue_1.6.2             digest_0.6.31          XVector_0.38.0        
[16] colorspace_2.1-0       htmltools_0.5.4        Matrix_1.5-3          
[19] R.oo_1.25.0            plyr_1.8.8             pkgconfig_2.0.3       
[22] misc3d_0.9-1           bookdown_0.33          zlibbioc_1.44.0       
[25] purrr_1.0.1            scales_1.2.1           tibble_3.2.0          
[28] farver_2.1.1           ggplot2_3.4.1          withr_2.5.0           
[31] cachem_1.0.7           ppcor_1.1              cli_3.6.0             
[34] magrittr_2.0.3         memoise_2.0.1          evaluate_0.20         
[37] R.methodsS3_1.8.2      fs_1.6.1               fansi_1.0.4           
[40] R.cache_0.16.0         doParallel_1.0.17      MASS_7.3-58.2         
[43] gplots_3.1.3           textshaping_0.3.6      tools_4.2.3           
[46] lifecycle_1.0.3        stringr_1.5.0          munsell_0.5.0         
[49] DelayedArray_0.24.0    compiler_4.2.3         pkgdown_2.0.7         
[52] jquerylib_0.1.4        caTools_1.18.2         systemfonts_1.0.4     
[55] rlang_1.1.0            grid_4.2.3             RCurl_1.98-1.10       
[58] iterators_1.0.14       labeling_0.4.2         bitops_1.0-7          
[61] tcltk_4.2.3            rmarkdown_2.20         gtable_0.3.1          
[64] codetools_0.2-19       reshape2_1.4.4         R6_2.5.1              
[67] knitr_1.42             fastmap_1.1.1          utf8_1.2.3            
[70] rprojroot_2.0.3        ragg_1.2.5             KernSmooth_2.23-20    
[73] desc_1.4.2             stringi_1.7.12         parallel_4.2.3        
[76] Rcpp_1.0.10            vctrs_0.6.0            xfun_0.37             </code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Reina Chau, Katia Bulekova, Vinay Kartha, Stefano Monti.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
