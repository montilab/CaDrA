<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Candidate Search — candidate_search • CaDrA</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Candidate Search — candidate_search"><meta property="og:description" content="Performs heuristic search on a set of binary features to determine whether
there are features whose union is more skewed (enriched at the extremes)
than either features alone. This is the main functionality of 
the CaDrA package."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CaDrA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Docs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/scoring_functions.html">Scoring Functions</a>
    </li>
    <li>
      <a href="../articles/permutation_based_testing.html">Permutation-Based Testing</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="../news/index.html">Change Log</a>
</li>
<li>
  <a href="https://github.com/montilab/CaDrA">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Candidate Search</h1>
    <small class="dont-index">Source: <a href="https://github.com/montilab/CaDrA/blob/HEAD/R/candidate_search.R"><code>R/candidate_search.R</code></a></small>
    <div class="hidden name"><code>candidate_search.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Performs heuristic search on a set of binary features to determine whether
there are features whose union is more skewed (enriched at the extremes)
than either features alone. This is the main functionality of 
the <code>CaDrA</code> package.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">candidate_search</span><span class="op">(</span></span>
<span>  <span class="va">FS</span>,</span>
<span>  <span class="va">input_score</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ks_pval"</span>, <span class="st">"ks_score"</span>, <span class="st">"wilcox_pval"</span>, <span class="st">"wilcox_score"</span>, <span class="st">"revealer"</span>, <span class="st">"custom"</span><span class="op">)</span>,</span>
<span>  method_alternative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"less"</span>, <span class="st">"greater"</span>, <span class="st">"two.sided"</span><span class="op">)</span>,</span>
<span>  custom_function <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  custom_parameters <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  search_start <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  top_N <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  search_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"both"</span>, <span class="st">"forward"</span><span class="op">)</span>,</span>
<span>  max_size <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  best_score_only <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  do_plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>FS</dt>
<dd><p>a matrix of binary features or a SummarizedExperiment class object 
from SummarizedExperiment package where rows represent features of interest 
(e.g. genes, transcripts, exons, etc...) and columns represent the samples. 
The assay of FS contains binary (1/0) values indicating the presence/absence 
of omics features.</p></dd>


<dt>input_score</dt>
<dd><p>a vector of continuous scores representing a phenotypic
readout of interest such as protein expression, pathway activity, etc.</p>
<p>NOTE: <code>input_score</code> object must have names or labels that match the 
column names of <code>FS</code> object.</p></dd>


<dt>method</dt>
<dd><p>a character string specifies a scoring method that is
used in the search. There are 6 options: (<code>"ks_pval"</code> or <code>ks_score</code>
or <code>"wilcox_pval"</code> or <code>wilcox_score</code> or 
<code>"revealer"</code> (conditional mutual information from REVEALER) or
<code>"custom"</code> (a user-defined scoring method)). 
Default is <code>ks_pval</code>.</p></dd>


<dt>method_alternative</dt>
<dd><p>a character string specifies an alternative 
hypothesis testing (<code>"two.sided"</code> or <code>"greater"</code> or <code>"less"</code>).
Default is <code>less</code> for left-skewed significance testing.</p>
<p>NOTE: This argument only applies to <code>ks_pval</code> and 
<code>wilcox_pval</code> method</p></dd>


<dt>custom_function</dt>
<dd><p>if method is <code>"custom"</code>, specifies
a user-defined function here. Default is <code>NULL</code>.</p>
<p>NOTE: <code>custom_function</code> must take FS and input_score as its
input arguments and its final result must return a vector of row-wise scores 
where its labels or names match the row names of <code>FS</code> object.</p></dd>


<dt>custom_parameters</dt>
<dd><p>if method is <code>"custom"</code>, specifies a list of
additional arguments (excluding <code>FS</code> and <code>input_score</code>) 
to be passed to the <code>custom_function</code>. For example:
custom_parameters = list(alternative = "less"). Default is <code>NULL</code>.</p></dd>


<dt>weights</dt>
<dd><p>if method is <code>ks_score</code> or <code>ks_pval</code>, specifying a 
vector of weights will perform a weighted-KS testing. Default is <code>NULL</code>.</p>
<p>NOTE: <code>weights</code> must have names or labels that match the labels of 
<code>input_score</code>.</p></dd>


<dt>search_start</dt>
<dd><p>a vector of character strings (separated by commas)
specifies feature names in the <code>FS</code> object to start the search with. 
If <code>search_start</code> is provided, then <code>top_N</code> parameter will be 
ignored and vice versa. Default is <code>NULL</code>.</p></dd>


<dt>top_N</dt>
<dd><p>an integer specifies the number of features to start the
search over. By default, it starts with the feature that has the highest 
best score (top_N = 1).</p>
<p>NOTE: If <code>top_N</code> is provided, then <code>search_start</code> parameter
will be ignored and vice versa. If top_N &gt; 10, it may result in a longer 
search time.</p></dd>


<dt>search_method</dt>
<dd><p>a character string specifies an algorithm to filter
out the best features (<code>"forward"</code> or <code>"both"</code>). Default is
<code>both</code> (i.e. backward and forward).</p></dd>


<dt>max_size</dt>
<dd><p>an integer specifies a maximum size that a meta-feature
can extend to do for a given search. Default is <code>7</code>.</p></dd>


<dt>best_score_only</dt>
<dd><p>a logical value indicates whether or not to return 
the best score corresponding to each top N searches only.
Default is <code>FALSE</code>.</p></dd>


<dt>do_plot</dt>
<dd><p>a logical value indicates whether or not to plot the
overlapping features of the resulting meta-feature matrix.</p>
<p>NOTE: plot can only be produced if the resulting meta-feature matrix contains 
more than 1 feature (e.g. length(search_start) &gt; 1 or top_N &gt; 1). 
Default is <code>FALSE</code>.</p></dd>


<dt>verbose</dt>
<dd><p>a logical value indicates whether or not to print the
diagnostic messages. Default is <code>FALSE</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>If <code>best_score_only = TRUE</code>, the heuristic search will return 
the best feature whose its union meta-feature matrix has the highest score 
among the <code>top_N</code> feature searches.
If <code>best_score_only = FALSE</code>, a list of objects pertaining to 
<code>top_N</code> feature searches will be returned. For each top_N feature search,
the candidate search will contain 7 objects: (1) its best meta-feature matrix 
(<code>feature_set</code>), (2) its observed input scores (<code>input_score</code>), 
(3) its corresponding best score pertaining to the union meta-feature
matrix (<code>score</code>), (4) names of the best meta-features (<code>best_features</code>), 
(5) rank of the best meta-features in term of their best scores (<code>best indices</code>), 
(6) marginal scores of the best meta-features (<code>marginal_best_scores</code>), 
(7) cumulative scores of the best meta-features (<code>cumulative_best_scores</code>).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>NOTE: The legacy function <code>topn_eval</code> is equivalent to the recommended
<code>candidate_search</code> function</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load pre-computed feature set</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sim_FS</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load pre-computed input scores</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sim_Scores</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define additional parameters and run the function</span></span></span>
<span class="r-in"><span><span class="va">candidate_search_result</span> <span class="op">&lt;-</span> <span class="fu">candidate_search</span><span class="op">(</span></span></span>
<span class="r-in"><span>  FS <span class="op">=</span> <span class="va">sim_FS</span>, input_score <span class="op">=</span> <span class="va">sim_Scores</span>, </span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"ks_pval"</span>, method_alternative <span class="op">=</span> <span class="st">"less"</span>, weights <span class="op">=</span> <span class="cn">NULL</span>, </span></span>
<span class="r-in"><span>  search_start <span class="op">=</span> <span class="cn">NULL</span>, top_N <span class="op">=</span> <span class="fl">3</span>, search_method <span class="op">=</span> <span class="st">"both"</span>,</span></span>
<span class="r-in"><span>  max_size <span class="op">=</span> <span class="fl">7</span>, best_score_only <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://github.com/RC-88" class="external-link">Reina Chau</a>, <a href="https://github.com/katgit" class="external-link">Katia Bulekova</a>, <a href="https://github.com/vkartha" class="external-link">Vinay Kartha</a>, <a href="https://github.com/tetomonti" class="external-link">Stefano Monti</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

